EESchema Schematic File Version 2
LIBS:power
LIBS:device
LIBS:transistors
LIBS:conn
LIBS:linear
LIBS:regul
LIBS:74xx
LIBS:cmos4000
LIBS:adc-dac
LIBS:memory
LIBS:xilinx
LIBS:microcontrollers
LIBS:dsp
LIBS:microchip
LIBS:analog_switches
LIBS:motorola
LIBS:texas
LIBS:intel
LIBS:audio
LIBS:interface
LIBS:digital-audio
LIBS:philips
LIBS:display
LIBS:cypress
LIBS:siliconi
LIBS:opto
LIBS:atmel
LIBS:contrib
LIBS:valves
EELAYER 25 0
EELAYER END
$Descr User 7874 5906
encoding utf-8
Sheet 1 1
Title "Linear currentsource"
Date "2016-04-16"
Rev "0.2"
Comp "http://jonnor.com"
Comment1 ""
Comment2 ""
Comment3 ""
Comment4 ""
$EndDescr
$Comp
L LM358 U1
U 1 1 5711412E
P 2500 3650
F 0 "U1" H 2450 3850 50  0000 L CNN
F 1 "LM358" H 2450 3400 50  0000 L CNN
F 2 "SMD_Packages:SOIC-8-N" H 2500 3650 50  0001 C CNN
F 3 "" H 2500 3650 50  0000 C CNN
	1    2500 3650
	1    0    0    -1  
$EndComp
$Comp
L LM358 U1
U 2 1 571141CE
P 3950 2650
F 0 "U1" H 3900 2850 50  0000 L CNN
F 1 "LM358" H 3900 2400 50  0000 L CNN
F 2 "SMD_Packages:SOIC-8-N" H 3950 2650 50  0001 C CNN
F 3 "" H 3950 2650 50  0000 C CNN
	2    3950 2650
	1    0    0    -1  
$EndComp
$Comp
L Q_NMOS_DGS Q1
U 1 1 57114293
P 5050 2650
F 0 "Q1" H 5350 2700 50  0000 R CNN
F 1 "PSMN017-30BL" H 5850 2600 50  0000 R CNN
F 2 "TO_SOT_Packages_SMD:TO-263-3Lead" H 5250 2750 50  0001 C CNN
F 3 "" H 5050 2650 50  0000 C CNN
	1    5050 2650
	1    0    0    -1  
$EndComp
$Comp
L R R5
U 1 1 5711479C
P 5150 3150
F 0 "R5" V 5230 3150 50  0000 C CNN
F 1 "0.1" V 5150 3150 50  0000 C CNN
F 2 "Resistors_SMD:R_2512" V 5080 3150 50  0001 C CNN
F 3 "" H 5150 3150 50  0000 C CNN
	1    5150 3150
	1    0    0    -1  
$EndComp
$Comp
L R R4
U 1 1 571147FF
P 4550 2650
F 0 "R4" V 4630 2650 50  0000 C CNN
F 1 "120" V 4550 2650 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 4480 2650 50  0001 C CNN
F 3 "" H 4550 2650 50  0000 C CNN
	1    4550 2650
	0    1    1    0   
$EndComp
$Comp
L R R3
U 1 1 571148F8
P 2450 4150
F 0 "R3" V 2530 4150 50  0000 C CNN
F 1 "100k" V 2450 4150 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 2380 4150 50  0001 C CNN
F 3 "" H 2450 4150 50  0000 C CNN
	1    2450 4150
	0    1    1    0   
$EndComp
$Comp
L R R2
U 1 1 57114971
P 2000 4000
F 0 "R2" V 2080 4000 50  0000 C CNN
F 1 "10k" V 2000 4000 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 1930 4000 50  0001 C CNN
F 3 "" H 2000 4000 50  0000 C CNN
	1    2000 4000
	1    0    0    -1  
$EndComp
$Comp
L R R1
U 1 1 57114A48
P 1800 4000
F 0 "R1" V 1880 4000 50  0000 C CNN
F 1 "12k" V 1800 4000 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 1730 4000 50  0001 C CNN
F 3 "" H 1800 4000 50  0000 C CNN
	1    1800 4000
	1    0    0    -1  
$EndComp
Wire Wire Line
	2600 4150 2900 4150
Wire Wire Line
	2900 4150 2900 3650
Wire Wire Line
	2000 3750 2150 3750
Wire Wire Line
	2150 3750 2200 3750
Wire Wire Line
	2000 3750 2000 3850
Wire Wire Line
	2300 4150 2150 4150
Wire Wire Line
	2150 4150 2150 3750
Connection ~ 2150 3750
Wire Wire Line
	3850 2950 3850 3150
$Comp
L VCC #PWR01
U 1 1 57114BAF
P 3850 1650
F 0 "#PWR01" H 3850 1500 50  0001 C CNN
F 1 "VCC" H 3850 1800 50  0000 C CNN
F 2 "" H 3850 1650 50  0000 C CNN
F 3 "" H 3850 1650 50  0000 C CNN
	1    3850 1650
	1    0    0    -1  
$EndComp
Wire Wire Line
	3850 1650 3850 1750
Wire Wire Line
	3850 1750 3850 2350
Wire Wire Line
	4700 2650 4850 2650
Wire Wire Line
	5150 2850 5150 2900
Wire Wire Line
	5150 2900 5150 3000
Wire Wire Line
	5150 3300 5150 3500
Connection ~ 5150 2900
Wire Wire Line
	2000 4150 2000 4250
Wire Wire Line
	2000 4250 2000 4400
Wire Wire Line
	1800 3850 1800 3550
Wire Wire Line
	1700 3550 1800 3550
Wire Wire Line
	1800 3550 2200 3550
Wire Wire Line
	1800 4150 1800 4250
Wire Wire Line
	1800 4250 2000 4250
Connection ~ 2000 4250
Text GLabel 5050 2900 0    60   BiDi ~ 0
I_sense
Wire Wire Line
	5050 2900 5150 2900
Text GLabel 1700 3550 0    60   BiDi ~ 0
I_sense
Connection ~ 1800 3550
Connection ~ 2900 3650
Wire Wire Line
	5150 2200 5150 2450
Wire Wire Line
	4250 2650 4400 2650
Wire Wire Line
	2800 3650 2900 3650
Wire Wire Line
	2900 3650 3000 3650
$Comp
L R R6
U 1 1 57115B1C
P 3150 3650
F 0 "R6" V 3230 3650 50  0000 C CNN
F 1 "10k" V 3150 3650 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 3080 3650 50  0001 C CNN
F 3 "" H 3150 3650 50  0000 C CNN
	1    3150 3650
	0    1    1    0   
$EndComp
Wire Wire Line
	3450 2750 3450 3650
Wire Wire Line
	3450 2750 3650 2750
$Comp
L GNDPWR #PWR02
U 1 1 57115ECA
P 5150 3500
F 0 "#PWR02" H 5150 3300 50  0001 C CNN
F 1 "GNDPWR" H 5150 3370 50  0000 C CNN
F 2 "" H 5150 3450 50  0000 C CNN
F 3 "" H 5150 3450 50  0000 C CNN
	1    5150 3500
	1    0    0    -1  
$EndComp
$Comp
L CONN_01X04 P1
U 1 1 57115F44
P 1550 1000
F 0 "P1" H 1550 1250 50  0000 C CNN
F 1 "CONN_01X04" V 1650 1000 50  0000 C CNN
F 2 "Pin_Headers:Pin_Header_Straight_1x04" H 1550 1000 50  0001 C CNN
F 3 "" H 1550 1000 50  0000 C CNN
	1    1550 1000
	1    0    0    -1  
$EndComp
Text GLabel 1200 850  0    60   Input ~ 0
VCC
Text GLabel 1200 950  0    60   Input ~ 0
PWM
Text GLabel 1200 1050 0    60   Input ~ 0
GND
Text GLabel 1200 1150 0    60   Input ~ 0
I_set
$Comp
L CONN_01X04 P2
U 1 1 571160BF
P 5500 1000
F 0 "P2" H 5500 1250 50  0000 C CNN
F 1 "CONN_01X04" V 5600 1000 50  0000 C CNN
F 2 "Pin_Headers:Pin_Header_Straight_1x04" H 5500 1000 50  0001 C CNN
F 3 "" H 5500 1000 50  0000 C CNN
	1    5500 1000
	1    0    0    -1  
$EndComp
Text GLabel 5150 850  0    60   Input ~ 0
GNDPWR
Text GLabel 5150 950  0    60   Input ~ 0
V+
Text GLabel 5150 1050 0    60   Output ~ 0
I_out+
Text GLabel 5150 1150 0    60   Output ~ 0
I_out-
Text GLabel 5300 2200 2    60   Output ~ 0
I_out-
Text GLabel 5300 1900 2    60   Output ~ 0
I_out+
Text GLabel 4950 1900 0    60   Input ~ 0
V+
Wire Wire Line
	5150 1150 5300 1150
Wire Wire Line
	5150 1050 5300 1050
Wire Wire Line
	5150 950  5300 950 
Wire Wire Line
	5150 850  5300 850 
Wire Wire Line
	1200 850  1350 850 
Wire Wire Line
	1200 950  1350 950 
Wire Wire Line
	1200 1050 1350 1050
Wire Wire Line
	1200 1150 1350 1150
$Comp
L C C1
U 1 1 5711663E
P 4100 1950
F 0 "C1" H 4125 2050 50  0000 L CNN
F 1 "1uF" H 4125 1850 50  0000 L CNN
F 2 "Capacitors_SMD:C_1206" H 4138 1800 50  0001 C CNN
F 3 "" H 4100 1950 50  0000 C CNN
	1    4100 1950
	1    0    0    -1  
$EndComp
Wire Wire Line
	4100 1750 4100 1800
Wire Wire Line
	4100 2100 4100 2150
$Comp
L GND #PWR04
U 1 1 5711682B
P 2850 3050
F 0 "#PWR04" H 2850 2800 50  0001 C CNN
F 1 "GND" H 2850 2900 50  0000 C CNN
F 2 "" H 2850 3050 50  0000 C CNN
F 3 "" H 2850 3050 50  0000 C CNN
	1    2850 3050
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR05
U 1 1 571168BC
P 2000 4400
F 0 "#PWR05" H 2000 4150 50  0001 C CNN
F 1 "GND" H 2000 4250 50  0000 C CNN
F 2 "" H 2000 4400 50  0000 C CNN
F 3 "" H 2000 4400 50  0000 C CNN
	1    2000 4400
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR06
U 1 1 57116905
P 3850 3150
F 0 "#PWR06" H 3850 2900 50  0001 C CNN
F 1 "GND" H 3850 3000 50  0000 C CNN
F 2 "" H 3850 3150 50  0000 C CNN
F 3 "" H 3850 3150 50  0000 C CNN
	1    3850 3150
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR07
U 1 1 5711694E
P 4100 2150
F 0 "#PWR07" H 4100 1900 50  0001 C CNN
F 1 "GND" H 4100 2000 50  0000 C CNN
F 2 "" H 4100 2150 50  0000 C CNN
F 3 "" H 4100 2150 50  0000 C CNN
	1    4100 2150
	1    0    0    -1  
$EndComp
$Comp
L BC849 Q2
U 1 1 57116A5F
P 2750 2700
F 0 "Q2" H 2950 2775 50  0000 L CNN
F 1 "BC849" H 2950 2700 50  0000 L CNN
F 2 "TO_SOT_Packages_SMD:SOT-323" H 2950 2625 50  0001 L CIN
F 3 "" H 2750 2700 50  0000 L CNN
	1    2750 2700
	1    0    0    -1  
$EndComp
$Comp
L R R9
U 1 1 57116A96
P 2850 2300
F 0 "R9" V 2930 2300 50  0000 C CNN
F 1 "100" V 2850 2300 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 2780 2300 50  0001 C CNN
F 3 "" H 2850 2300 50  0000 C CNN
	1    2850 2300
	1    0    0    -1  
$EndComp
$Comp
L R R7
U 1 1 57116BC8
P 1950 2700
F 0 "R7" V 2030 2700 50  0000 C CNN
F 1 "1k" V 1950 2700 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 1880 2700 50  0001 C CNN
F 3 "" H 1950 2700 50  0000 C CNN
	1    1950 2700
	0    1    1    0   
$EndComp
Wire Wire Line
	2850 2900 2850 3000
Wire Wire Line
	2850 3000 2850 3050
Wire Wire Line
	2850 2500 2850 2450
Wire Wire Line
	2100 2700 2550 2700
Wire Wire Line
	3350 2550 3650 2550
Wire Wire Line
	3350 2050 3350 2050
Wire Wire Line
	3350 2050 3350 2550
Wire Wire Line
	2100 2050 2250 2050
Wire Wire Line
	2250 2050 2850 2050
Wire Wire Line
	2850 2050 3350 2050
Wire Wire Line
	2850 2050 2850 2150
$Comp
L C C2
U 1 1 5711798C
P 2250 2300
F 0 "C2" H 2275 2400 50  0000 L CNN
F 1 "1uF" H 2275 2200 50  0000 L CNN
F 2 "Capacitors_SMD:C_1206" H 2288 2150 50  0001 C CNN
F 3 "" H 2250 2300 50  0000 C CNN
	1    2250 2300
	1    0    0    -1  
$EndComp
$Comp
L R R8
U 1 1 57117AB3
P 1950 2050
F 0 "R8" V 2030 2050 50  0000 C CNN
F 1 "100k" V 1950 2050 50  0000 C CNN
F 2 "Resistors_SMD:R_1206" V 1880 2050 50  0001 C CNN
F 3 "" H 1950 2050 50  0000 C CNN
	1    1950 2050
	0    1    1    0   
$EndComp
Wire Wire Line
	2250 2050 2250 2050
Wire Wire Line
	2250 2050 2250 2150
Connection ~ 2250 2050
Connection ~ 2850 2050
Text GLabel 1600 2050 0    60   Input ~ 0
I_set
Wire Wire Line
	1600 2050 1800 2050
Wire Wire Line
	2250 2450 2250 3000
Wire Wire Line
	2250 3000 2850 3000
Connection ~ 2850 3000
Text GLabel 1600 2700 0    60   Input ~ 0
PWM
Wire Wire Line
	1600 2700 1800 2700
Wire Wire Line
	3300 3650 3450 3650
Text Label 3350 2050 0    60   ~ 0
I_target
Text Label 3450 3650 0    60   ~ 0
I_feedback
Connection ~ 3450 3650
Connection ~ 3350 2050
Wire Wire Line
	5300 2200 5150 2200
Wire Wire Line
	4950 1900 5300 1900
Wire Wire Line
	4100 1750 3850 1750
Connection ~ 3850 1750
$EndSCHEMATC
